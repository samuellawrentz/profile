{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/monitor-website-pagespeed-with-googlesheets/","result":{"data":{"mdx":{"id":"41fbde3b-732a-5160-b7d9-6d21591f6597","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Monitor your website speed using Pagespeed API and Google Sheets\",\n  \"path\": \"/blog/monitor-website-pagespeed-with-googlesheets/\",\n  \"description\": \"Everyone loves speed - be it cars, superbikes, or websites. A good website loads content within the blink of an eye. This post covers how to monitor your website pagespeed using google sheets. Click to read more.\",\n  \"heroImage\": \"./pagespeed.jpg\",\n  \"tags\": [\"javascript\", \"automation\"],\n  \"published\": true,\n  \"date\": \"2022-08-12T00:00:00.000Z\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Banner = makeShortcode(\"Banner\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Everyone loves speed - be it cars, superbikes, or websites. A good website (like this one \\uD83D\\uDE09) loads content within the blink of an eye. A fast website can generate a lot of traffic easily. Users feel energetic and comfortable in using a website that responds quickly to their inputs. To measure the speed and performance, you need to be introduced to PageSpeed.\"), mdx(\"h2\", null, \"PageSpeed \\u26A1\\uFE0F\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developers.google.com/speed/docs/insights/v5/get-started\"\n  }, \"PageSpeed Insights\"), \" is a google metric that helps developers and businesses to find out how their website performs and loads on different devices and conditions. A good website must have a PageSpeed above 90, where 100 is the best.\"), mdx(\"p\", null, \"The PageSpeed of this website is almost 95-98. I'm planning to make it 100 soon, stay tuned.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/0df1eb5b5c2a004b1dadabcf8877ed15/e04e6/pagespeed.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"49%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABvUlEQVQoz32SPWtTYRTH79qlS5wyORhIFolOVYNWQ1MqaatDIYqQzVUICNKlnUToLBS/gR/DycFFh5YYqhZtKUjSe5N703vv8/aT5741tuKBP+dwnnP+5+1xtDYYk0Kbf9uz+J/YdycPMqRaJ/jbVyRoTSwEsZREUYQQItG+7ye2FWe2cqQln8YDvvg/EEYVVbXWif3t4ID7rRbNlRWWmk1uLSyw1GrRXl9ne2vrnDCXiY74cPqZj94eUyPyvlAqJe/3+9RqNR7cvcfD5WWuVSp0Ox3e777j1ebmOaFNsF0oqRj8/sn34QlaGaQ2SEVB+HUwoF6vc6fR4HajwY1qle1ej7ev3/Cy10sJLZHdQzCd4roe7mjE8PSMExcmIQSRQcqsw/19rpfLVEtXqJRK1ObnuVkuc3VujhfdbtZhfowwRMQxKp4kCx6LkDiO07dsh78OD3m+scGTR6s8W1vjabtNZ7XN48VFdnd2UkIpZJGQXjIb36S6ONrMwc0M8kwpZbIax418hu4Qb+wRBMHlv5UxhVow8l08zyMKw0txdipL6ggtOR4f459NCudF2MpSKY7cI9zAxU51MSaf8g/fw8hLA3qLUgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"This sites Pagespeed\",\n    \"title\": \"This sites Pagespeed\",\n    \"src\": \"/static/0df1eb5b5c2a004b1dadabcf8877ed15/c1b63/pagespeed.png\",\n    \"srcSet\": [\"/static/0df1eb5b5c2a004b1dadabcf8877ed15/5a46d/pagespeed.png 300w\", \"/static/0df1eb5b5c2a004b1dadabcf8877ed15/0a47e/pagespeed.png 600w\", \"/static/0df1eb5b5c2a004b1dadabcf8877ed15/c1b63/pagespeed.png 1200w\", \"/static/0df1eb5b5c2a004b1dadabcf8877ed15/d61c2/pagespeed.png 1800w\", \"/static/0df1eb5b5c2a004b1dadabcf8877ed15/e04e6/pagespeed.png 2152w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"You can get the speed insights of your website here - \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pagespeed.web.dev/\"\n  }, \"Google PageSpeed Insigts\")), mdx(Banner, {\n    mdxType: \"Banner\"\n  }, \"There are a few ways to improve PageSpeed, but it's a topic for another post.\"), mdx(\"h3\", null, \"PageSpeed API\"), mdx(\"p\", null, \"This API is provided by google so that you can fetch your PageSpeed scores programmatically using the API. To get started, you have to create a google project and \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://console.developers.google.com/apis/credentials\"\n  }, \"enable API usage.\"), \" You will get an \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"API Key\"), \". This is required to make API calls to the google PageSpeed server. Google has a free tier so cost shouldn't be a concern.\"), mdx(\"h2\", null, \"Google Sheets Apps Script\"), mdx(\"p\", null, \"Google sheet has a section that allows you to write scripts that can be triggered automatically. The syntax looks like plain Javascript, but its called \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.google.com/script/start/\"\n  }, \"Apps Script or Google Script\"), \". You can find it in Extensions > Apps Script.\"), mdx(\"h3\", null, \"Ok fine, How do we do the monitoring part?\"), mdx(\"p\", null, \"You can make an API call to fetch the PageSpeed data and then write it to the last row in the sheet once everyday. In this manner, we can have a track of daily PageSpeed data and it can be used for further analytics.\"), mdx(\"p\", null, \"You can even set up a mail alert if the PageSpeed goes than, say 80 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"(I'm leaving it upto you, my fellow developer)\"), \". The AppsScript code is as follows, put it in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Code.gs\"), \" file in the script editor.\"), mdx(\"deckgo-highlight-code\", {\n    \"language\": \"js\"\n  }, \"\\n          \", mdx(\"code\", {\n    parentName: \"deckgo-highlight-code\",\n    \"slot\": \"code\"\n  }, \"// Code.gs\\n\\n// You can insert all the pages that you want to monitor into this array.\\nvar urls = ['www.samuellawrentz.com'];\\nvar lastRow = 0;\\n\\nfunction initialize(){\\n  lastRow = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet().getLastRow() + 1;\\n  var dateCell = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet().getRange(lastRow, 1);\\n  \\n  // Set the date on the first column\\n  dateCell.setValue(new Date()).setNumberFormat(\\\"dd/MM/yyyy\\\");\\n  urls.forEach(function(item, index){\\n  myFunction(item, index)\\n});\\n}\\n\\n\\nfunction myFunction(url, index) {\\n  var url = 'https://www.googleapis.com/pagespeedonline/v5/runPagespeed?url=https%3A%2F%2F'+ encodeURIComponent(url)+'&category=performance&key=YOUR_API_KEY_GOES_HERE';\\n  var options = {\\n    'method': 'get'\\n  };\\n  var response = UrlFetchApp.fetch(url, options);\\n  addData(response, index);\\n}\\n\\n// Write the data to the next row to the last filled row\\nfunction addData(response, index) {\\n  var res = JSON.parse(response.getContentText());\\n  var cell = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet().getRange(lastRow, index + 2);\\n  cell.setValue(res.lighthouseResult.categories.performance.score * 100);\\n  \\n}\"), \"\\n        \"), mdx(\"p\", null, \"Set up a trigger \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"(can be found on the left side bar of the editor)\"), \" that fires every day at midnight. You can see this script doing its work automatically every night for you. You can look at my google sheet for reference - \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.google.com/spreadsheets/d/15O2yPtvmFZvEEaxoZqpR-LksZ7CQR9SJjC5WETNgtaU/edit?usp=sharing\"\n  }, \"https://docs.google.com/spreadsheets/d/15O2yPtvmFZvEEaxoZqpR-LksZ7CQR9SJjC5WETNgtaU/edit?usp=sharing\")), mdx(\"p\", null, \"As you can see, I started the script recently. I'm planning to use the data for further analysis and produce historical charts later down the road. If you wanna know my journey to start this blog read - \\\"\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://samuellawrentz.com/blog/how-i-started-a-tech-blog/\"\n  }, \"How I started a tech blog?\"), \"\\\"\"), mdx(\"p\", null, \"\\u26A1\\uFE0F\\u26A1\\uFE0F\\u26A1\\uFE0F\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"Monitor your website speed using Pagespeed API and Google Sheets","description":"Everyone loves speed - be it cars, superbikes, or websites. A good website loads content within the blink of an eye. This post covers how to monitor your website pagespeed using google sheets. Click to read more.","date":"12 Aug, 2022","path":"/blog/monitor-website-pagespeed-with-googlesheets/","tags":["javascript","automation"],"heroImage":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBP/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHMlsTCExf/xAAZEAEAAwEBAAAAAAAAAAAAAAACAREiACH/2gAIAQEAAQUCeXVKaiToP19//8QAFxEBAAMAAAAAAAAAAAAAAAAAAgEQE//aAAgBAwEBPwHVKa//xAAXEQADAQAAAAAAAAAAAAAAAAACEBEx/9oACAECAQE/AQmL/8QAGRABAAMBAQAAAAAAAAAAAAAAAQAQESES/9oACAEBAAY/AvI4TvdoWNf/xAAaEAACAwEBAAAAAAAAAAAAAAABEQAhMUEQ/9oACAEBAAE/IcQHhImIqmbhoSpWV2GW+ef/2gAMAwEAAgADAAAAEMfv/8QAGREBAAIDAAAAAAAAAAAAAAAAAQARMVHR/9oACAEDAQE/ELIca5An/8QAFxEBAQEBAAAAAAAAAAAAAAAAASEAQf/aAAgBAgEBPxBkinct3//EABoQAQEBAQEBAQAAAAAAAAAAAAERACFBYZH/2gAIAQEAAT8QpuXOBCaBlPQA/uXLEAPYMoOqQ+TV4+vXf//Z","aspectRatio":1.7716535433070866,"src":"/static/497b25a4570097de3c9afe89be1e5b4e/14b42/pagespeed.jpg","srcSet":"/static/497b25a4570097de3c9afe89be1e5b4e/07ab6/pagespeed.jpg 225w,\n/static/497b25a4570097de3c9afe89be1e5b4e/32fd5/pagespeed.jpg 450w,\n/static/497b25a4570097de3c9afe89be1e5b4e/14b42/pagespeed.jpg 800w","sizes":"(max-width: 800px) 100vw, 800px"}}}}}},"pageContext":{"title":"Monitor your website speed using Pagespeed API and Google Sheets","id":"41fbde3b-732a-5160-b7d9-6d21591f6597"}},"staticQueryHashes":["3412710006"]}